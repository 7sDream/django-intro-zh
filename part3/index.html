
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Django 官方教程中文版">
      
      
        <link rel="canonical" href="https://7sdream.github.io/django-intro-zh/part3/">
      
      
        <meta name="author" content="7sDream">
      
      
        <link rel="shortcut icon" href="../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.8.1">
    
    
      
        <title>第一个 Django 项目 - 第三部分 - Django intro 中文版</title>
      
    
    
      <script src="../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-bfecc7305d.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="https://7sdream.github.io/django-intro-zh/" title="Django intro 中文版" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  文档
                </span>
              
            
            第一个 Django 项目 - 第三部分
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/7sDream/django-intro-zh" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      django-intro-zh
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    Django intro 中文版
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/7sDream/django-intro-zh" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      django-intro-zh
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="介绍" class="md-nav__link">
      介绍
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      文档
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        文档
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../glance/" title="初识 Django" class="md-nav__link">
      初识 Django
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/" title="快速安装指南" class="md-nav__link">
      快速安装指南
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part1/" title="第一个 Django 项目 - 第一部分" class="md-nav__link">
      第一个 Django 项目 - 第一部分
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part2/" title="第一个 Django 项目 - 第二部分" class="md-nav__link">
      第一个 Django 项目 - 第二部分
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        第一个 Django 项目 - 第三部分
      </label>
    
    <a href="./" title="第一个 Django 项目 - 第三部分" class="md-nav__link md-nav__link--active">
      第一个 Django 项目 - 第三部分
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="总概" class="md-nav__link">
    总概
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="编写更多的视图" class="md-nav__link">
    编写更多的视图
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="写一个真正有用的视图" class="md-nav__link">
    写一个真正有用的视图
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#render" title="一个快捷函数：render()" class="md-nav__link">
    一个快捷函数：render()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#404" title="抛出 404 错误" class="md-nav__link">
    抛出 404 错误
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get_object_of_404" title="一个快捷函数：get_object_of_404()" class="md-nav__link">
    一个快捷函数：get_object_of_404()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="使用模板系统" class="md-nav__link">
    使用模板系统
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#url" title="去除模板中的硬编码 URL" class="md-nav__link">
    去除模板中的硬编码 URL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#url_1" title="为 URL 名称添加命名空间" class="md-nav__link">
    为 URL 名称添加命名空间
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part4/" title="第一个 Django 项目 - 第四部分" class="md-nav__link">
      第一个 Django 项目 - 第四部分
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part5/" title="第一个 Django 项目 - 第五部分" class="md-nav__link">
      第一个 Django 项目 - 第五部分
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part6/" title="第一个 Django 项目 - 第六部分" class="md-nav__link">
      第一个 Django 项目 - 第六部分
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../part7/" title="第一个 Django 项目 - 第七部分" class="md-nav__link">
      第一个 Django 项目 - 第七部分
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../whats_next/" title="下一步我该干什么" class="md-nav__link">
      下一步我该干什么
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../reusable_app/" title="编写可重用的应用" class="md-nav__link">
      编写可重用的应用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../patch/" title="为 Django 贡献代码" class="md-nav__link">
      为 Django 贡献代码
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="总概" class="md-nav__link">
    总概
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="编写更多的视图" class="md-nav__link">
    编写更多的视图
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="写一个真正有用的视图" class="md-nav__link">
    写一个真正有用的视图
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#render" title="一个快捷函数：render()" class="md-nav__link">
    一个快捷函数：render()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#404" title="抛出 404 错误" class="md-nav__link">
    抛出 404 错误
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get_object_of_404" title="一个快捷函数：get_object_of_404()" class="md-nav__link">
    一个快捷函数：get_object_of_404()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="使用模板系统" class="md-nav__link">
    使用模板系统
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#url" title="去除模板中的硬编码 URL" class="md-nav__link">
    去除模板中的硬编码 URL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#url_1" title="为 URL 名称添加命名空间" class="md-nav__link">
    为 URL 名称添加命名空间
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="django">创建你的第一个 Django 项目， 第三部分</h1>
<p>这一篇从 <a href="../part2/">第二部分（zh）</a>结尾的地方继续。我们将继续编写投票应用，并且着力于如何创建公用接口 —— “视图”。</p>
<h2 id="_1">总概</h2>
<p>Django 中的视图的概念是「一类具有相同功能和模板的网页的集合」。比如，在一个博客应用中，你可能会创建如下几个视图：</p>
<ul>
<li>博客首页 —— 展示最近的一些记录。</li>
<li>内容详情页 —— 详细展示某项内容。</li>
<li>以年为单位的归档页 —— 展示选中的年份里各个月份创建的内容。</li>
<li>以月为单位的归档页 —— 展示选中的月份里各天创建的内容。</li>
<li>以天为单位的归档页 —— 展示选中天里创建的所有内容。</li>
<li>评论页 —— 用于响应为一项内容添加评论的操作。</li>
</ul>
<p>而在投票应用中，我们需要下列几个视图：</p>
<ul>
<li>问题索引页 —— 展示最近的几个投票问题。</li>
<li>问题详情页 —— 展示某个投票的问题和不带结果的选项列表。</li>
<li>问题结果页 —— 展示某个投票的结果。</li>
<li>投票页 —— 用于响应用户为某个问题的特定选项投票的操作。</li>
</ul>
<p>在 Django 中，网页和其他内容都是从视图派生而来。每一个视图表现为一个简单的 Python 函数（或者说方法，如果是在基于类的视图里的话）。Django 将会根据用户请求的 URL 来选择使用哪个视图（更准确的说，是根据 URL 中域名之后的部分）。</p>
<p>在你上网的过程中，很可能看见过像这样美丽的 URL：“ME2/Sites/dirmod.asp?sid=&amp;type=gen&amp;mod=Core+Pages&amp;gid=A6CD4967199A42D9B65B1B”。别担心，Django 里的 URL 要比这优雅的多！</p>
<p>一个 URL 模式定义了某种 URL 的基本格式 —— 举个例子：</p>
<p><strong>/newsarchive/&lt;year&gt;/&lt;month&gt;/</strong></p>
<p>为了将 URL 和视图关联起来，Django 使用了 “URLconfs” 来配置。URLconf 将 URL 模式（表现为一个正则表达式）映射到视图。</p>
<p>本教程只会介绍 URLconf 的基础内容，你可以查看 <a href="https://docs.djangoproject.com/en/1.11/ref/urlresolvers/#module-django.urls"><strong>django.core.urlresolvers</strong></a> 以获取更多内容。</p>
<h2 id="_2">编写更多的视图</h2>
<p>现在让我们添加更多的视图进 <strong>polls/view.py</strong>，这些视图都有点不一样，因为它们都接受一个参数：</p>
<div class="codehilite"><pre><span></span><span class="c1"># polls/views.py</span>

<span class="k">def</span> <span class="nf">detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;You&#39;re looking at question </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">question_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">results</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;You&#39;re looking at the results of question </span><span class="si">%s</span><span class="s2">.&quot;</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">response</span> <span class="o">%</span> <span class="n">question_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">vote</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;You&#39;re voting on question </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">question_id</span><span class="p">)</span>
</pre></div>


<p>要把这些新视图添加进 <strong>polls.urls</strong> 模块里，只需添加几个 <strong>url()</strong> 函数调用：</p>
<div class="codehilite"><pre><span></span><span class="c1"># polls/urls.py</span>

<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ex: /polls/</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">),</span>
    <span class="c1"># ex: /polls/5/</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;question_id&gt;[0-9]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;detail&#39;</span><span class="p">),</span>
    <span class="c1"># ex: /polls/5/results/</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;question_id&gt;[0-9]+)/results/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">results</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;results&#39;</span><span class="p">),</span>
    <span class="c1"># ex: /polls/5/vote/</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;question_id&gt;[0-9]+)/vote/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">vote</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;vote&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>然后在你的浏览器里转到 “/polls/34/”，Django 将会运行 <strong>detail()</strong> 方法并展示你在 URL 里提供的问题 ID。再试试 “/polls/34/results” 和 “/polls/34/vote/” —— 你将会看到暂时用于占位的结果和投票页。</p>
<p>当某人请求你网站的某一页面时——比如说，“/polls/34/”，Django 将会载入 <strong>mysite.urls</strong> 模块，因为配置项 <a href="https://docs.djangoproject.com/en/1.11/ref/settings/#std:setting-ROOT_URLCONF"><strong>ROOT_URLCONF</strong></a> 说要载入它。然后 Django 寻找名为 <strong>urlpatterns</strong> 变量并且按序遍历正则表达式。Django 找到匹配的正则表达式 <strong>'^polls/'</strong> 
然后 Django 将会去除被匹配的部分（<strong>polls/</strong>）,然后发送剩下的文本 —— <strong>“34/”</strong> —— 给 “polls.urls” 这个 URLconf 做进一步处理。然后找到匹配的正则表达式 <strong>r'^(?P<question_id>[0-9]+)/$'</strong>，随后用以下方式调用 <strong>detail()</strong> 函数：</p>
<div class="codehilite"><pre><span></span><span class="n">detail</span><span class="p">(</span><span class="n">request</span><span class="o">=&lt;</span><span class="n">HttpRequest</span> <span class="nb">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">question_id</span><span class="o">=</span><span class="s1">&#39;34&#39;</span><span class="p">)</span>
</pre></div>


<p><strong>question_id='34'</strong> 这一部分是由 <strong>(?P<question_id>[0-9+])</strong> 产生的。使用括号来包围一部分模式，就可以“捕获”这部分所匹配到的文本，随后作为参数被传递给视图函数；<strong>?P<question_id></strong> 用于定义匹配部分的名字；<strong>[0-9]+</strong> 是用于匹配一连串数字（也就是所有整数）的正则表达式。</p>
<p>因为 URL 模式本质上是正则表达式，所以不会有规定限制你如何使用它们。还有，没必要为每个 URL 加上不必要的东西，例如 <strong>.html</strong>。不过如果你非要加的话，也是可以的：</p>
<div class="codehilite"><pre><span></span><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^polls/latest\.html$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
</pre></div>


<p>但是，别这样做，这太傻了。</p>
<h2 id="_3">写一个真正有用的视图</h2>
<p>每个视图必须要做的只有两件事：返回一个包含被请求页面内容的 <a href="https://docs.djangoproject.com/en/1.11/ref/request-response/#django.http.HttpResponse"><strong>HttpResponse</strong></a> 对象，或者抛出一个异常，比如 <a href="https://docs.djangoproject.com/en/1.11/topics/http/views/#django.http.Http404"><strong>Http404</strong></a>。至于你还想干些什么，都随你。</p>
<p>你的视图可以从数据库里读取记录，可以使用一个模板引擎（比如 Django 自带的，或者其他第三方的），可以生成一个 PDF 文件，可以输出一个 XML，创建一个 ZIP 文件，你可以做任何你想做的事，使用任何你想用的 Python 库。</p>
<p>Django 只是需要一个 <a href="https://docs.djangoproject.com/en/1.11/ref/request-response/#django.http.HttpResponse"><strong>HttpResponse</strong></a>，或者一个异常。</p>
<p>因为 Django 自带的数据库 API 很方便（我们在 <a href="../part2/">在第二部分（zh）</a>里介绍过），所以我们试试在视图里使用它。我们在 <strong>index()</strong> 函数里插入了一些新内容，让它能展示数据库里按发布日期倒序的最近五个投票问题，以逗号分割：</p>
<div class="codehilite"><pre><span></span><span class="c1"># polls/views.py</span>

<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Question</span>


<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">latest_question_list</span> <span class="o">=</span> <span class="n">Question</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-pub_date&#39;</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">q</span><span class="o">.</span><span class="n">question_text</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">latest_question_list</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="c1"># 暂时不管剩下的视图 (detail, results, vote)</span>
</pre></div>


<p>这里有个问题：页面的设计是硬编码在视图函数的代码里的。如果你想改变页面的样子，你就要编辑 Python 代码。所以让我们使用 Django 的模板系统，只要创建一个视图，就可以将页面的设计从代码中分离出来。</p>
<p>首先，在你的 <strong>polls</strong> 目录里创建一个 <strong>templates</strong> 目录。Django 将会在这个目录里查找模板文件。</p>
<p>你项目的 <a href="https://docs.djangoproject.com/en/1.11/topics/templates/"><strong>TEMPLATES</strong></a> 配置项描述了 Django 如何加载和渲染模板。默认的设置文件设置了 <strong>DjangoTemplates</strong> 后端，并将 <a href="https://docs.djangoproject.com/en/1.11/ref/settings/#std:setting-TEMPLATES-APP_DIRS"><strong>APP_DIRS</strong></a> 设置成了 <strong>True</strong>。这一选项将会让 <strong>DjangoTemplates</strong> 在每个 <a href="https://docs.djangoproject.com/en/1.11/ref/settings/#std:setting-INSTALLED_APPS"><strong>INSTALLED_APPS</strong></a> 中激活的应用文件夹中寻找 “templates” 子目录。</p>
<p><strong>templates</strong> 目录建好后，在里面再创建一个目录 <strong>polls</strong>，在这个 <strong>polls</strong> 的目录里再建立一个文件 <strong>index.html</strong>。换句话说，你的模版路径应该是 <strong>polls/templates/polls/index.html</strong>。由于 <strong>app_directories</strong> 模版加载器的工作原理如上所述，所以你使用简单的 <strong>polls/index.html</strong> 就能引用这模版了。</p>
<blockquote>
<p>模板命名空间</p>
<p>虽然我们现在可以将模板文件直接放在 <strong>polls/templates</strong> 文件夹中（而不是再建立一个 <strong>polls</strong> 子文件夹），但这不是个好办法。Django 将会选择第一个匹配的模板文件，如果你有一个模板文件正好和另一个应用中的某个模板文件重名，Django 没有办法区分它们。我们需要 Django 选择正确的模板，最简单的方法就是把他们放入各自的命名空间中，也就是把这些模板放入一个和自身应用重名的子文件夹里。</p>
</blockquote>
<p>将下面的代码输入到刚刚创建的模板文件中：</p>
<div class="codehilite"><pre><span></span><span class="c">&lt;!-- polls/templates/polls/index.html --&gt;</span>

{% if latest_question_list %}
    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
    {% for question in latest_question_list %}
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/polls/{{ question.id }}/&quot;</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    {% endfor %}
    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
{% else %}
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>No polls are available.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
{% endif %}
</pre></div>


<p>为了使用这个模版，让我们更新一下在 <strong>polls/views.py</strong> 里的 <strong>index</strong> 视图：</p>
<div class="codehilite"><pre><span></span><span class="c1"># polls/views.py</span>

<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
<span class="kn">from</span> <span class="nn">django.template</span> <span class="kn">import</span> <span class="n">loader</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Question</span>


<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">latest_question_list</span> <span class="o">=</span> <span class="n">Question</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-pub_date&#39;</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;polls/index.html&#39;</span><span class="p">)</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;latest_question_list&#39;</span><span class="p">:</span> <span class="n">latest_question_list</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">request</span><span class="p">))</span>
</pre></div>


<p>上述代码的作用是，加载 <strong>polls/index.html</strong> 模板，并且向它传递一个上下文环境（context）。这个上下文是一个字典，它将模板内的变量映射为 Python 对象。</p>
<p>在你的浏览器访问 “/polls/”，你将会看见一个无序列表，列出了我们在 <a href="../part2/">教程二（zh）</a>中添加的 “What's up” 投票问题，它链接到这个问题的详情页。</p>
<h2 id="render">一个快捷函数：<a href="https://docs.djangoproject.com/en/1.11/topics/http/shortcuts/#django.shortcuts.render">render()</a></h2>
<p>「载入模板，填充上下文，再返回由它生成的 HttpResponse 对象」是一个如此常用的操作流程。于是 Django 提供了一个快捷函数，我们用它来重写 <strong>index()</strong> 视图：</p>
<div class="codehilite"><pre><span></span><span class="c1"># polls/views.py</span>

<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Question</span>


<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">latest_question_list</span> <span class="o">=</span> <span class="n">Question</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-pub_date&#39;</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latest_question_list&#39;</span><span class="p">:</span> <span class="n">latest_question_list</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;polls/index.html&#39;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</pre></div>


<p>注意，我们不再需要导入 <strong>loader</strong> 和 <strong>HttpResponse</strong>。不过如果你还有其他函数（比如说 <strong>detail</strong>，<strong>results</strong> 和 <strong>vote</strong>）需要用到它的话，就需要保持 HttpResponse 的导入。</p>
<p><a href="https://docs.djangoproject.com/en/1.11/topics/http/shortcuts/#django.shortcuts.render"><strong>render()</strong></a> 函数把请求(HttpRequest)对象作为第一个参数，加载的模版名字作为第二个参数，用于渲染模板的上下文字典作为可选的第三个参数。函数返回一个 <a href="https://docs.djangoproject.com/en/1.11/ref/request-response/#django.http.HttpResponse"><strong>HttpResponse</strong></a> 对象，内容为指定模板用指定上下文渲染后的结果。</p>
<h2 id="404">抛出 404 错误</h2>
<p>现在，让我们来处理下投票详情视图 —— 它会显示指定投票的问题标题。下面是这个视图的代码：</p>
<div class="codehilite"><pre><span></span><span class="c1"># polls/views.py</span>

<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">Http404</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Question</span>
<span class="c1"># ...</span>
<span class="k">def</span> <span class="nf">detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">question</span> <span class="o">=</span> <span class="n">Question</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">question_id</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">Question</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Http404</span><span class="p">(</span><span class="s2">&quot;Question does not exist&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;polls/detail.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;question&#39;</span><span class="p">:</span> <span class="n">question</span><span class="p">})</span>
</pre></div>


<p>这里有个新概念：如果指定问题 ID 所对应的问题不存在，这个视图就会抛出一个 <a href="https://docs.djangoproject.com/en/1.11/topics/http/views/#django.http.Http404"><strong>Http404</strong></a> 异常。</p>
<p>我们稍后再讨论你需要在 <strong>polls/details.html</strong> 里输入什么，但是如果你想试试上面这段代码是否正常工作的话，你可以暂时把下面这段输进去：</p>
<div class="codehilite"><pre><span></span><span class="c">&lt;!-- polls/templates/polls/details.html --&gt;</span>

{{ question }}
</pre></div>


<p>这样你就能测试了。</p>
<h2 id="get_object_of_404">一个快捷函数：<a href="https://docs.djangoproject.com/en/1.11/topics/http/shortcuts/#django.shortcuts.get_object_or_404">get_object_of_404()</a></h2>
<p>「用 <a href="https://docs.djangoproject.com/en/1.11/ref/models/querysets/#django.db.models.query.QuerySet.get"><strong>get()</strong></a> 函数获取对象，抛出 <a href="https://docs.djangoproject.com/en/1.11/topics/http/views/#django.http.Http404"><strong>Http404</strong></a>错误」也是一个常用流程。Django 也提供了一个快捷函数，下面是重写的 <strong>detail()</strong> 视图：</p>
<div class="codehilite"><pre><span></span><span class="c1"># polls/views.py</span>

<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">get_object_or_404</span><span class="p">,</span> <span class="n">render</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Question</span>
<span class="c1"># ...</span>
<span class="k">def</span> <span class="nf">detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="n">question</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Question</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">question_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;polls/detail.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;question&#39;</span><span class="p">:</span> <span class="n">question</span><span class="p">})</span>
</pre></div>


<p><a href="https://docs.djangoproject.com/en/1.11/topics/http/shortcuts/#django.shortcuts.get_object_or_404"><strong>get_object_of_404()</strong></a> 函数的第一个参数是一个 Django 模型。在此之后可以有任意个的关键字参数，他们会被直接传递给模型的 <a href="https://docs.djangoproject.com/en/1.11/ref/models/querysets/#django.db.models.query.QuerySet.get"><strong>get()</strong></a> 函数。如果对象并不存在，此快捷函数将会抛出一个 <a href="https://docs.djangoproject.com/en/1.11/topics/http/views/#django.http.Http404"><strong>Http404</strong></a> 异常。</p>
<blockquote>
<p><strong>设计哲学</strong></p>
<p>为什么我们使用辅助函数 <a href="https://docs.djangoproject.com/en/1.11/topics/http/shortcuts/#django.shortcuts.get_object_or_404"><strong>get_object_of_404()</strong></a> 而不是自己捕获 <a href="https://docs.djangoproject.com/en/1.11/ref/exceptions/#django.core.exceptions.ObjectDoesNotExist"><strong>ObjectDoesNotExist</strong></a> 异常呢？或者，为什么模型 API 不直接抛出 <a href="https://docs.djangoproject.com/en/1.11/topics/http/views/#django.http.Http404"><strong>Http404</strong></a> 而是抛出 <a href="https://docs.djangoproject.com/en/1.11/ref/exceptions/#django.core.exceptions.ObjectDoesNotExist"><strong>ObjectDoesNotExist</strong></a> 呢？</p>
<p>因为这样做会增加模型层和视图层的耦合度。指导 Django 设计的最重要的思想之一就是要保证松散耦合。一些受控的耦合将会被包含在 <a href="https://docs.djangoproject.com/en/1.11/topics/http/shortcuts/#module-django.shortcuts"><strong>django.shortcuts</strong></a> 模块中。</p>
</blockquote>
<p>也有 <a href="https://docs.djangoproject.com/en/1.11/topics/http/shortcuts/#django.shortcuts.get_object_or_404"><strong>get_list_of_404()</strong></a> 函数，工作原理和 <a href="https://docs.djangoproject.com/en/1.11/topics/http/shortcuts/#django.shortcuts.get_object_or_404"><strong>get_object_of_404()</strong></a> 一样，除了 <a href="https://docs.djangoproject.com/en/1.11/ref/models/querysets/#django.db.models.query.QuerySet.get"><strong>get()</strong></a> 函数被换成了 <a href="https://docs.djangoproject.com/en/1.11/ref/models/querysets/#django.db.models.query.QuerySet.filter"><strong>filter()</strong></a> 函数。如果列表为空的话会抛出 <a href="https://docs.djangoproject.com/en/1.11/topics/http/views/#django.http.Http404"><strong>Http404</strong></a> 异常。</p>
<h2 id="_4">使用模板系统</h2>
<p>回过头去看看我们的 <strong>detail()</strong> 视图。它向模板传递了上下文变量 <strong>question</strong>。下面是 <strong>polls/detail.html</strong> 模板里的代码：</p>
<div class="codehilite"><pre><span></span><span class="c">&lt;!--- polls/templates/polls/detail.html --&gt;</span>

<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
{% for choice in question.choice_set.all %}
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>{{ choice.choice_text }}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
{% endfor %}
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre></div>


<p>模板系统统一使用「点」符号来访问变量的属性。在示例 <strong>{{ question.question_text }}</strong> 中，首先 Django 尝试对 <strong>Question</strong> 对象使用字典查找（也就是使用obj.get(str)操作），如果失败了就尝试属性查找（也就是obj.str操作），结果是成功了。如果这一操作也失败的话，将会尝试列表查找（也就是obj[int]操作）。</p>
<p>在 <a href="https://docs.djangoproject.com/en/1.11/ref/templates/builtins/#std:templatetag-for"><strong>{% for %}</strong></a> 循环中发生的函数调用：
<strong>question.choice_set.all</strong> 被解释为 Python 代码 <strong>question.choice_set.all()</strong>，将会返回一个可迭代的 <strong>Choice</strong> 对象，这一对象可以在<a href="https://docs.djangoproject.com/en/1.11/ref/templates/builtins/#std:templatetag-for"><strong>{% for %}</strong></a> 标签内部使用。</p>
<p>查看 <a href="https://docs.djangoproject.com/en/1.11/topics/templates/">模板指南</a> 可以了解关于模板的更多信息。</p>
<h2 id="url">去除模板中的硬编码 URL</h2>
<p>还记得吗，我们在 <strong>polls/index.html</strong> 里编写投票链接时，链接是硬编码的：</p>
<div class="codehilite"><pre><span></span><span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/polls/{{ question.id }}/&quot;</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</pre></div>


<p>问题在于，硬编码和强耦合的链接，对于一个包含很多应用的项目来说，修改起来是十分困难的。然而，因为你在 <strong>polls.urls</strong> 的 <strong>urls()</strong> 函数中通过 name 参数为 URL 定义了名字，你可以使用 <strong>{% url %}</strong> 标签代替它：</p>
<div class="codehilite"><pre><span></span><span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;detail&#39; question.id %}&quot;</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</pre></div>


<p>这个标签的工作方式是在 <strong>polls.urls</strong> 模块的 URL 定义中寻具有指定名字的条目。你可以回忆一下，具有名字 “detail” 的 URL 是这样被定义的：</p>
<div class="codehilite"><pre><span></span><span class="o">...</span>
<span class="c1"># name 变量被 {% url %} 标签调用</span>
<span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;question_id&gt;[0-9]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;detail&#39;</span><span class="p">),</span>
<span class="o">...</span>
</pre></div>


<p>如果你想改变投票详情视图的 URL，比如想改成 <strong>polls/specifics/12/</strong>，你不用在模板里修改任何东西，只要在 <strong>polls/urls.py</strong> 里稍微修改一下就行：</p>
<div class="codehilite"><pre><span></span><span class="o">...</span>
<span class="c1"># 增加 specifics</span>
<span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^specifics/(?P&lt;question_id&gt;[0-9]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;detail&#39;</span><span class="p">),</span>
<span class="o">...</span>
</pre></div>


<h2 id="url_1">为 URL 名称添加命名空间</h2>
<p>本教程的项目只有一个应用，<strong>polls</strong>。在一个真实的 Django 项目中，可能会有五个，十个，二十个甚至更多应用。Django 如何分辨重名的 URL 呢？举个例子，<strong>polls</strong> 应用有 <strong>detail</strong> 视图，可能另一个博客应用也有同名的视图。Django 如何知道 <strong>{% url %}</strong> 标签到底对应哪一个应用的 URL 呢？</p>
<p>答案是：在 URLconf 中添加命名空间。在 <strong>polls/urls.py</strong> 文件中添加 <strong>app_name</strong> 变量作为应用的命名空间：</p>
<div class="codehilite"><pre><span></span><span class="c1"># polls/urls.py</span>

<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">app_name</span> <span class="o">=</span> <span class="s1">&#39;polls&#39;</span>
<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;question_id&gt;[0-9]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;detail&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;question_id&gt;[0-9]+)/results/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">results</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;results&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;question_id&gt;[0-9]+)/vote/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">vote</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;vote&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>现在，修改 <strong>polls/index.html</strong> 模版文件，从：</p>
<div class="codehilite"><pre><span></span><span class="c">&lt;!--- polls/templates/polls/index.html --&gt;</span>

<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;detail&#39; question.id %}&quot;</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</pre></div>


<p>修改成：</p>
<div class="codehilite"><pre><span></span><span class="c">&lt;!--- polls/templates/polls/index.html --&gt;</span>

<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;polls:detail&#39; question.id %}&quot;</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</pre></div>


<p>当你弄懂如何编写视图之后，就可以去看教程的 <a href="../part4/">教程第四部分（zh）</a>，来学习关于表单处理和视图类的相关内容。</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../part2/" title="第一个 Django 项目 - 第二部分" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                第一个 Django 项目 - 第二部分
              </span>
            </div>
          </a>
        
        
          <a href="../part4/" title="第一个 Django 项目 - 第四部分" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                第一个 Django 项目 - 第四部分
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-6940329b9f.js"></script>
      
      
      <script>app.initialize({url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>